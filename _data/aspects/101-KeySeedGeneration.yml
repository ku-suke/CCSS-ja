###################################################
#
#  CryptoCurrency Security Standard (CCSS)
#
#  Copyright (c) 2016, CryptoCurrency Certification Consortium (C4)
#  See license.md
#
###################################################

id: 1.01
title: 鍵／シードの生成
file: 101-KeySeedGeneration


category: 暗号資産管理

description: >
 この観点は、暗号通貨システム内で使用される[暗号鍵](#key) と[シード](#seed)の生成を対象としています。 暗号鍵とシードを安全に作成するには、機密性と推測できない数の2つが必要です。 新しく作成された暗号鍵またはシードが意図しない者によって読み取られたりコピーされたりしないようにするには、機密性が必要です。 新たに作成された暗号鍵が意図しない当事者によって推測または特定されないようにするには、推測できない数が必要です。 以下にリストされた各ゴールは、暗号鍵やシードが機密で推測不能な方法で作成されるという保証を提供します。

level_one:
  - 利用する[暗号鍵](#key) と[シード](#seed)は、その[利用者](#actor) によって作成されます。これは、鍵の機密性を保護するための試みです。ある利用者が生成した後に別の利用者に暗号鍵またはシードを転送する必要があるシステムでは、自動署名エージェントの初期設定を除き、レベルIを達成できません。
  - 自動化されたエージェントが暗号鍵・シードを利用する場合、そのシステムの管理者は十分な[エントロピー](#entropy) を持つ適切なオフラインシステム上で暗号鍵・シードを生成し、この暗号鍵・シードをターゲットデバイスに[安全に転送](#strong-encryption)  し、CCSS準拠のデータサニタイズ技術を使用して安全に削除して、暗号鍵・シードの機密性を保護します。
  - 特に、バックアップ目的のために暗号鍵のシークレットを転送することは、「同一利用者要件」に違反しない。 ただし、これらのシークレットは[強力に暗号化された](#strong-encryption) 形式で送信および格納する必要があります。
  - 利用する[暗号鍵](#key) と[シード](#seed)は、十分な[エントロピー](#entropy) を持つシステム上に作成され、値の範囲の縮小やその他の決定論的特性に向かう偏りを伴ってキーが作成されないようにします。

level_two:
  - ソフトウェアの監査後、デジタル署名を生成して公開する必要があります。ソフトウェアがセキュリティ監査を通過してから変更されていないことを確認するために、署名をソフトウエアの実行前に検証する必要があります。
  - 暗号鍵やシードがソフトウェアを使用せずに作成された場合（例えば、さいころ、カードのデッキ、または他の非デジタル[エントロピー](#entropy) ）、作成手法を検証して確定性が存在しないことを保証する必要があります（つまり、さいころに偏りがない、デッキ内の各カードは一意であるなど）。

level_three:
  - 利用する[暗号鍵](#key) または[シード](#seed)は、[NIST SP 800-90A](http：//csrc.nist.gov/publications/nistpubs/800-90A/SP800-90A.pdf)に準拠する決定論的乱数生成器(Deterministic Random Bit Generator; DRBG)を使用して生成されを使用して生成され、暗号論的に安全に結合された少なくとも2つの独立した暗号で保護されたエントロピーのソースがシードされています。（例えば、SHA256 [推測不可能な要素1 + 推測不可能な要素2]）。 NIST SP 800-90Aは、決定論的に生成された数値が確定的なシードに関してランダムな分布に従うことを保証する標準です。 したがって、これらの乱数を決定する能力は、DRBGのシードを発見する能力を低下させる。
  - NIST SP 800-90AのDual_EC DRBGは[脆弱](https://en.wikipedia.org/wiki/Dual_EC_DRBG)であることが実証されており、使用すべきではありません。
  - オプションで、NIST SP 800-90A準拠のDRBGの代わりに、上記で指定した2つのシードを組み合わせて、暗号鍵またはシードを非決定論的乱数生成器( Non-deterministic Random Bit Generator / NRBG )または「真性乱数生成回路 (True Random Number Generator/TRNG)」を使用して、[DIEHARD](http://www.stat.fsu.edu/pub/diehard/)、Crypt-X、 [NIST STS](http://csrc.nist.gov/groups/ST/toolkit/rng/documentation_software.html)などのランダム性の業界標準統計テストに合格させます。


components:
  - component: &010101
    id: 1.1.1
    title_short: オペレーターが生成した暗号鍵・シード
    uncertified: 暗号鍵・シードは別の利用者から鍵保管者に発行された
    level_one: 暗号鍵・シードは利用者自身で生成した
    level_two: 暗号鍵・シードは利用者自身で生成した
    level_three: 暗号鍵・シードは利用者自身で生成した
  - component: &010102
    id: 1.1.2
    title_short: 生成手法が検証されている
    uncertified:
    level_one:
    level_two: 暗号鍵・シードの生成手法は、使用前に検証されています
    level_three: 暗号鍵・シードの生成手法は、使用前に検証されています
  - component: &010103
    id: 1.1.3
    title_short: DRBG 準拠
    uncertified: 暗号鍵・シードは DRBG に準拠していない方法で生成されています
    level_one: 暗号鍵・シードはNIST SP 800-90A準拠の決定論的乱数生成器を使用して生成されています
    level_two: 暗号鍵・シードは、NIST SP 800-90A準拠のDRBGを使用して作成され、単一の暗号論的に安全なエントロピーのソースがシードになっています
    level_three: |
      暗号鍵/シードは、NIST SP 800-90A準拠のDRBGを使用して作成され、複数の暗号論的に安全なエントロピーのソース
      または
      業界標準の統計テスト（DIEHARD、Crypt-X、NIST STS）に合格した非決定論的乱数生成器がシードになっています
  - component: &010104
    id: 1.1.4
    title_short: エントロピープール
    uncertified: 暗号鍵・シードはエントロピーが不十分なシステムで生成される
    level_one: 暗号鍵・シードはエントロピーが十分なシステムで生成される
    level_two: 暗号鍵・シードはエントロピーが十分なシステムで生成される
    level_three: 暗号鍵・シードはエントロピーが十分なシステムで生成される